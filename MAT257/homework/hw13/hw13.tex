\documentclass{article}
\usepackage[margin=1.0in]{geometry}
\usepackage{amssymb,amsmath,amsthm,amsfonts}
\usepackage{enumitem}
\usepackage{xcolor}
\usepackage{mathtools}
\usepackage{systeme}

% My boxes
\usepackage[breakable]{tcolorbox}

% \RequirePackage{background}
% \backgroundsetup{
%     scale=1,
%     color=black,
%     opacity=1,
%     angle=0,
%     contents={
%         \includegraphics[width=\paperwidth,height=\paperheight]{\nightmodebackground}
%     }
% }

\definecolor{pastelblue}{RGB}{96, 145, 245}
\definecolor{pastelgreen}{RGB}{106, 235, 135}
\definecolor{darkgray}{RGB}{60, 60, 60}
\definecolor{lightgray}{RGB}{180, 180, 180}
\definecolor{offwhite}{RGB}{225, 225, 245}


\pagecolor{darkgray}
\color{offwhite}

\newcommand{\Z}{\mathbf{Z}}
\newcommand{\N}{\mathbf{N}}
\newcommand{\R}{\mathbf{R}}
\newcommand{\Q}{\mathbf{Q}}
\newcommand{\C}{\mathbf{C}}

\newcommand{\id}{\mathrm{id}}
\newcommand{\op}{\mathrm{op}}
\newcommand{\diam}{\mathrm{diam}}
\newcommand{\GL}{\mathrm{GL}}
\newcommand{\Tr}{\mathrm{Tr}}
\newcommand{\im}{\mathrm{im}}
\newcommand{\rank}{\mathrm{rank}}

\newcommand{\cl}[1]{\overline{#1}}

\swapnumbers % places numbers before thm names

\theoremstyle{plain} % The "plain" style italicizes all body text.
	\newtheorem{thm}{Theorem}
		\numberwithin{thm}{section} % Theorem numbers are determined by section.
	\newtheorem{lemma}[thm]{Lemma}
	\newtheorem{prop}[thm]{Proposition}
	\newtheorem{cor}[thm]{Corollary}

\theoremstyle{definition}
    \newtheorem{defn}[thm]{Definition}
	\newtheorem{example}[thm]{Example}
	\newtheorem{exercise}[thm]{Exercise} %Exercise

\begin{document}
    \newtcolorbox{question}[2][]{fonttitle=\large, fontupper=\large, fontlower=\large, title=Question {#2}., oversize, arc=3mm, outer arc=2mm, opacityback=0.9, coltitle=offwhite, colframe=pastelblue, colback=darkgray, colupper=lightgray, collower=lightgray, leftrule=1mm, rightrule=1mm, toprule=1.5mm, titlerule=1mm, bottomrule=1mm, valign=center, add to natural height=5mm, lower separated=false, before lower=\begin{proof}, after lower= \smallbreak \end{proof}, #1, breakable=true}

    \begin{question}{35}
        \textit{Perturbing the roots of a polynomial.}
    
    Let $f(x)=\sum_{i=0}^n a_ix^i$ be a \textbf{monic} polynomial with \textbf{no repeated real roots}. This means that $a_n=1$, and that all real roots of $f$ have multiplicity $1$.
    \begin{enumerate}[label=(\alph*)]
        \item 
        
        Let $r$ be a root of $f(x)$. Prove that for all $\varepsilon>0$, there exists $\delta>0$ such that: if $g(x)=\sum_{i=0}^n b_ix^i$ is a monic polynomial with coefficients $b_i$ satisfying $|a_i-b_i|<\delta$, then $g(x)$ has at least one root in the interval $(r-\varepsilon,r+\varepsilon)$.

        This shows that slight perturbations of the coefficients results in slight perturbations of the roots.
        
        \item Suppose that $f$ has fewer than $n$ real roots. Prove that number of real roots of $f$ does not change under small perturbation of the coefficients.
    \end{enumerate}

    \tcblower
    \ 

    (a):

    First, we prove the following lemma:

    \textbf{Lemma.} Let \(r \in \mathbb{R}\) be a root of a polynomial \(p\). Then \(r\) is a repeated root if and only if \(p'(r) = 0\).

    Suppose that \(p\) has a repeated root. Then we can factor \(p\) as \((x - r)^k q(x)\), for some \(k > 1\) and \(q \in \mathbb{P} (\mathbb{R})\). We can take the derivative of this and get that
    \[
        p'(x) = k(x - r)^{k-1} q(x) + (x - r)^k q'(x)
    \]
    \[
        \implies p'(r) = 0
    \]
    Conversely, suppose that \(p'(r) = 0\), for some \(r \in \mathbb{R}\). We can write
    \[
        p'(x) = (x - r)\sum_{i=0}^{m} c_i x^i, \text{ for constants } c_0, ..., c_m
    \]
    We can integrate both sides to get that
    \[
        p(x) = \int (x - r) \sum_{i=0}^{m} c_i x_i\ dx = \int x\sum_{i=0}^{m} c_i x_i - r\sum_{i=0}^{m} c_i x_i\ dx
    \]
    \[
        = \sum_{i=0}^{m} \frac{c_i}{i+2}x^{i+2} - r \sum_{i=0}^{m} \frac{c_i}{i+1}x^{i+1} + C
    \]
    In order for \(r\) to be a root of \(p\), we must have that
    \[
        p(r) = \sum_{i=0}^{m} \left(\frac{c_i}{i+2}r^{i+2} - \frac{c_i}{i+1}r^{i+2}\right) + C = 0
    \]
    \[
        \implies C = \sum_{i=0}^{m} \left(\frac{c_i}{i+1}r^{i+2} - \frac{c_i}{i+2}r^{i+2}\right)
    \]
    Therefore (im sorry)
    \begin{align*}
        p(x) &= \sum_{i=0}^{m} \left( \frac{c_i}{i+2}x^{i+2} - \frac{c_i}{i + 2}r^{i+2} + \frac{c_i}{i+1}r^{i+2} - r\frac{c_i}{i + 1}x^{i+1} \right) \\
        &= \sum_{i=0}^{m} \left( \left( \frac{c_i}{i+2} \right)(x^{i+2} - r^{i+2}) - \left( \frac{c_i r}{i + 1} \right)(x^{i+1} - r^{i+1})\right) \\
        &= \sum_{i=0}^{m} \left( \left( \frac{c_i}{i + 2} \right)(x - r) \sum_{j=0}^{i+1} x^j r^{i - j + 1} - \left( \frac{c_i}{i + 1} \right)(x - r)\sum_{j=0}^{i} x^j r^{i-j+1} \right) \\
        &= (x - r)\sum_{i=0}^{m} \left( \frac{c_i}{(i+1)(i+2)} \left( (i + 1)\left(x^{i+1} + \sum_{j=0}^{i} x^j r^{i-j+1} \right) - (i + 2)\sum_{j=0}^{i} x^j r^{i-j+1} \right) \right) \\
        &= (x - r)\sum_{i=0}^{m} \left( \frac{c_i}{(i+1)(i+2)}\left( (i+1)x^{i+1} - \sum_{j=0}^{i}x^j r^{i-j+1} \right) \right) \\
        &= (x-r)\sum_{i=0}^{m} \left( \frac{c_i}{(i+1)(i+2)} \sum_{j=0}^{i} (x^{i+1} - x^j r^{i-j+1})\right) \\
        &= (x-r)\sum_{i=0}^{m} \left( \frac{c_i}{(i+1)(i+2)} \sum_{j=0}^{i} x^j (x^{i-j+1} - r^{i-j+1})\right) \\
        &= (x-r)\sum_{i=0}^{m} \left( \frac{c_i}{(i+1)(i+2)} \sum_{j=0}^{i} x^j (x-r)\sum_{k=0}^{i-j} x^k r^{i-j-k+1}\right) \\
        &= (x-r)^2\sum_{i=0}^{m} \left( \frac{c_i}{(i+1)(i+2)} \sum_{j=0}^{i} \sum_{k=0}^{i-j} x^{k+j} r^{i-j-k+1}\right) \\
    \end{align*}
    which implies that \(r\) is a repetaed root of \(p\).

    Define the \(C^1\) function \(\Phi : \mathbb{R}^{n+2} \to \mathbb{R}\) by
    \[
        \Phi (y_0, y_1, ..., y_{n+1}, x) = \sum_{i=0}^{n} y_i x^i.
    \]
    Let \(a = (a_0, ..., a_n) \in \mathbb{R}^{n+1}\). We have that \(\Phi (a, r) = 0\) and as well, by our lemma,
    
    \(\dfrac{\partial \Phi}{\partial x}(a, r) = f'(r) \neq 0\). Applying the Implicit Function Theorem, we get that for some open set \(W \subseteq \mathbb{R}^{n+1}\) and \(C^1\) function \(\Psi : W \to \mathbb{R}\) such that \(\Psi (a) = r\),
    \[
        \Phi (b, \Psi (b)) = 0, \text{ for all } b \in W.
    \]
    Now, let \(\varepsilon > 0\). by the continuity of \(\Psi\) at \(a\), there exists a \(\delta > 0\) so that for all \(b \in W\) with \(\|b - a\| < (n+1)\delta\), \(|\Psi (b) - r| < \varepsilon\), so \(\Psi (b) \in (r - \varepsilon, r + \varepsilon)\). Consider the polynomial
    \[
        g(x) = \sum_{i=0}^{n} b_i x^i = \Phi (b,x)
    \]
    Where \(|a_i - b_i| < \delta\). It follows that
    \[
        (n+1)\delta > \sum_{i=0}^{n} |a_i - b_i| > \|a - b\|
    \]
    which implies that \(\Psi (b) \in (r - \varepsilon, r + \varepsilon)\). But notice that \(\Psi (b)\) is actually a root of \(g(x)\), as desired.

    \medskip

    (b):

    From part (a), we know that the number of roots can never decrease under small perturbations. Thus, it suffices to show that it will never increase, either.

    First, we will strengthen the statement in part (a) so that for small enough \(\varepsilon\), there is exactly one root in the interval \((r - \varepsilon, r + \varepsilon)\). By the continuity of \(\dfrac{\partial \Phi}{\partial x}\), we obtain \(\xi > 0\) so that for \((c,s) \in \mathbb{R}^{n+1} \times \mathbb{R}\) such that \(\|(c,s) - (a,r)\| < \xi\),
    \[
        \left\vert \dfrac{\partial \Phi}{\partial x}(c,s) - \dfrac{\partial \Phi}{\partial x}(a,r) \right\vert < \frac{1}{2}\dfrac{\partial \Phi}{\partial x}(a,r)
    \]
    \[
        \implies \frac{1}{2}\dfrac{\partial \Phi}{\partial x} < \dfrac{\partial \Phi}{\partial x}(c,s) < \frac{3}{2}\dfrac{\partial \Phi}{\partial x}(a,r)
    \]
    Since \(\dfrac{\partial \Phi}{\partial x}(a,r) \neq 0\), it follows that \(\dfrac{\partial \Phi}{\partial x}(c,s) \neq 0\) as well. Let \(\varepsilon < \frac{\xi}{2}\). Define \(\delta _a\) as the value we found in part (a) for this value of \(\varepsilon\). Let \(g\) be a polynomial with coefficients \(b_i\) such that \(|a_i - b_i| < \min \left\{\delta_a, \dfrac{\xi}{2(n+1)}\right\}\). Then \(g(x) = \Phi (b, x)\) and \(g'(x) = \dfrac{\partial \Phi}{\partial x}(b,x)\). But notice that for \(|x - r| < \varepsilon = \frac{\xi}{2}\), we have that
    \[
        \|(b,x) - (a,r)\| \leq \sum_{i=0}^{n} |a_i - b_i| + |x - r| < \frac{(n+1)\xi}{2(n+1)} + \frac{\xi}{2} = \xi,
    \]
    so \(g'(x) = \dfrac{\partial \Phi}{\partial x}(b,x) \neq 0\), which implies that \(g\) is injective on the interval \((r - \varepsilon, r + \varepsilon)\). We already knew that \(g(\Psi (b)) = 0\), now we know that this is the only root in the interval.

    For every root \(r\), we have an associated interval \((r - \varepsilon _r, r + \varepsilon _r)\) such that \(g\) contains exactly one root within them. Finally, we must show that outside of all these intervals, \(g\) does not gain any new roots. To do this, we have to shrink \(\delta\) even further. Let \(R\) be the finite set of all the roots of \(f\). Let \(V = \mathbb{R}\setminus \bigcup_{r \in R} (r - \varepsilon_r, r + \varepsilon _r)\). Consider the set
    \[
        S = |f(V)|
    \]
    Notice that \(\inf S > 0\). We use the fact that \(f \in \Omega (x^n)\) to claim that for all \(|x| > x_0\), we have
    \[
        |f(x)| \geq \eta |x|^n, \text{ for some } \eta > 0.
    \]
    Let \(m = \max \{1, x_0\}\). Let \(\delta = \min \left\{ \delta_a, \dfrac{\xi}{2(n+1)}, \dfrac{\eta}{2(n+1)}, \dfrac{\inf S}{2m^n(n+1)} \right\}\). Let \(x \in V\). We have that
    \[
        ||f(x)| - |g(x)|| \leq |f(x) - g(x)| = \left\vert \sum_{i=0}^{n} a_i x^i - \sum_{i=0}^{n} b_i x^i \right\vert \leq \sum_{i=0}^{n} |a_i - b_i| |x|^i
    \]
    Consider the case where \(|x| > m\). We get
    \[
        | |f(x) - |g(x)| | \leq \sum_{i=0}^{n} |a_i - b_i| |x|^i < \sum_{i=0}^{n} \frac{\eta}{2(n+1)} |x|^n = \frac{\eta}{2}|x|^n
    \]
    \[
        \implies |g(x)| > |f(x)| - \frac{\eta}{2}|x|^n \geq \eta |x|^n - \frac{\eta}{2}|x|^n > 0
    \]
    Otherwise, if \(|x| \leq m\),
    \[
        | |f(x)| - |g(x)| | \leq \sum_{i=0}^{n} |a_i - b_i| |x|^i \leq \sum_{i=0}^{n} \frac{\inf S}{2m^n(n+1)}m^i \geq \sum_{i=0}^{n} \frac{\inf S}{2m^n(n+1)}m^n
    \]
    \[
        \implies |g(x)| > |f(x)| - \frac{\inf S}{2} \geq \inf S - \frac{\inf S}{2} = \frac{\inf S}{2} > 0
    \]
    In either case, we see that \(g\) has no roots in \(V\).

    Therefore, we see that any \(g\) with coefficients \(\delta\)-close to \(f\) has exactly one root close to each root of \(f\), and no other roots, so we can conclude that \(g\) exactly the same number of roots as \(f\).
    \end{question}
\end{document}